#include <windows.h>  // Include the Windows API header

int main() {
    unsigned int eax, ebx, ecx, edx;

    // Set EAX to 0x1 to get the CPU feature information
    eax = 1;

    // Execute the CPUID instruction
    __asm__ volatile (
        "cpuid"
        : "=a" (eax), "=b" (ebx), "=c" (ecx), "=d" (edx)
        : "a" (eax)
    );

    // Check if the 31st bit of ECX is set
    if (ecx & (1 << 31)) {
        MessageBox(NULL, "Hypervisor detected!", "Detection Result", MB_OK | MB_ICONINFORMATION);
    } else {
        MessageBox(NULL, "No hypervisor detected.", "Detection Result", MB_OK | MB_ICONINFORMATION);
    }

    return 0;
}

